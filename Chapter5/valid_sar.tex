The SAR is the stage providing most of the complete ADC resolution. As the SAR is only a stage from the ADC, none of its metric reflects the ADC performance. With a digital scheme being pseudo-synchronous, and the two first bits given by the previous stage, the test of this stage over the large temperature range from -40\(\degree \)C to +175\(\degree \)C poses an interesting challenge.

In addition to that, while the generation of an accurate and linear differential input to test a 6-bit ADC is not difficult to achieve, the timely generation of the two first bits given to the SAR is a struggling point. Yet, static metric contains meaningful information on the thermal dependence of the stage, which can be related the ADC temperature sensitivity. Despite the gain and offset errors are a good estimator and their dependence to the temperature is a key factor, a more accurate understanding of the temperature dependence come from the analysis of the calibration coefficients' variation over temperature. Their variations allow one to detect which group of capacitors and switches generate the possible failure. That said, the non linearity will indicates error either in the settling or in the comparator decision if no failure is detected.

In order to calculate the metric, the transfer function of the ADC shall be collected at different temperature. The servo loop methodology, finding the input voltage at the transitions between two output codes, has not been selected since no transition exists for extreme input voltage values. The latter making difficult the estimation of small gain error.

To extract the total transfer function of the SAR, a ramp is generated for each quadrant defined by the two bits given as depicted by \figurename~\ref{fig:sar-test-input}. 

\begin{figure}[htp]
    \centering
    \includegraphics[height=5cm]{Chapter5/Figs/sar_test/sar-test-input.eps}
    \caption{Input voltage profile and quadrant sent to the SAR under test}
    \label{fig:sar-test-input}
\end{figure}

\subsection{Measures}
The basic setup for the test is depicted by the \figurename~\ref{fig:sar-test-connections}. This includes five power supplies, a multimeter, an oscilloscope with DSO, and an optional current source. Among power supplies, two are for the power distribution. One a 1.8 V for the core, and one at 3.3 V for the level shifting needs of the digital signals connected to NI-USB boxes. The remaining three are dedicated to reference voltages.

\begin{figure}[htp]
    \centering
    \includegraphics[width=.8\textwidth]{Chapter5/Figs/sar_test/board_test_setup.png}
    \caption{Motherboard connections of bench top devices for the test of the Sub-ADC}
    \label{fig:sar-test-connections}
\end{figure}

The differential input voltage has been generated with an Hameg HMP4040 automated through the GPIB bus. About the digital signals sent, they are generated by an NI-USB 8452 and drive directly pads of the test chip. Inside it, those signals are reshaped with a Schmitt trigger inside the chip. The RESETN signal is asynchronous and resets all digital parts. Due to the different time to respond of each signal generator, the quadrant could be received by the test chip far before or after the input voltage change. To prevent erroneous conversions, overlapping range of the \figurename~\ref{fig:sar-test-input} are 300 mV large around the quadrant transitions. This allows a change within a range of sample that will be removed to get the transfer function.

\begin{figure}[htp]
    \centering
    \includegraphics[width=0.5\textwidth]{Chapter5/Figs/sar_test/sar-tf-overlapp.ps}
    \caption{Reconstruction of the transfer function of the SAR with overlapping handling}
    \label{fig:sar-tf-overlap}
\end{figure}

Once the measure under the thermal stream performed, we extracted the transfer function. Due to the overlapping ranges in the test stimulus, we decided to keep the output data only in accordance with the expected ideal two first bits the algorithmic would have given. Represented in \figurename~\ref{fig:sar-tf-overlap}, the transfer function is given by only one sweep of the triangular input signal given. Based on that, an example of measurements data collected for a SAR at 175$\degree$ is given in \figurename~\ref{fig:sar-vin-to-dnl-proc}. This figure depicts the different steps from the input voltage measures to the estimation of the DNL expressed in LSB of a 6-bit ADC\@.
\begin{figure}[htp]
    \centering
    \includegraphics[width=\textwidth]{Chapter5/Figs/sar_test/graph/sar-process-175deg-osr_6.png}
    \begin{subfigure}[t]{0.25\textwidth}
        \subcaption{Input voltage applied}
    \end{subfigure}
    \begin{subfigure}[t]{0.15\textwidth}
        \subcaption{Quadrant detection}
    \end{subfigure}
    \begin{subfigure}[t]{0.25\textwidth}
        \subcaption{Transfer Function}
    \end{subfigure}
    \begin{subfigure}[t]{0.25\textwidth}
        \subcaption{DNL}
    \end{subfigure}
    \caption{Example of data collected and processed for a DOE\_SAR test chip at 175$\degree$C at 6 clock cycles per sample}
    \label{fig:sar-vin-to-dnl-proc}
\end{figure}

Knowing the input voltage given, the results of fitting the output code to input signal gives the calibration coefficients to minimize the error committed. The error between these coefficients and the ones given by the equation~(\ref{eqn:output_voltage_dac_sar}) in section~\ref{sec:capacitive-dac-sar-design} is then divided by the weight given by this equation for the LSB\@.
Repeated for each temperature, this ratio thus represents by how much the calibration coefficients shall change to get the lowest non-linearity. Represented in \figurename~\ref{fig:sar-test-coef_doe05_11} for a typical sample, the error on these coefficients does not exceed $\pm$35 \%. In other terms, the ideal bit weights can be kept to achieve the lowest non-linearity.

\begin{figure}[htp]
    \centering
    \input{Chapter5/Figs/sar_test/sar_coef_doe05_11.pgf}
    \caption{Binary weight error in the code of the SAR with respect to the ideal LSB weight versus the temperature}
    \label{fig:sar-test-coef_doe05_11}
\end{figure}

On an extreme edge case in the samples, the error could reach up to 68 \% of the LSB weight at 200$\degree$C. This scenario is represented by the \figurename~\ref{fig:sar-test-coef_doe05_13}, in which the limit for 50 \% of the LSB is highlighted. The crossing occurs for a temperature of 180$\degree$C. The error occurs above the operating range of the design, we consider the last stage as calibration free.

\begin{figure}[htp]
    \centering
    \input{Chapter5/Figs/sar_test/sar_coef_doe05_13.pgf}
    \caption{Binary weight error in the code of the SAR with respect to the ideal LSB weight versus the temperature}
    \label{fig:sar-test-coef_doe05_13}
\end{figure}

It is important to notice, that the SAR employs the Double Tail comparator. This work demonstrates the good operation of the Double-Tail latch even at high temperature. Second, the increasing error on the LSB above 180$\degree$C have been replicated for another sample when the epoxy resin becomes fluid. Due to the different coefficient of thermal expansion between the epoxy and the silicon, the wire bonding of CoB samples underwent a strong shear stress altering the analogue voltage.
